<!DOCTYPE html>
<html lang="es">

<head>
    {% include "includes/head.html" with title="Buscar" %}
    <link rel="stylesheet" href="/static/rateyo/jquery.rateyo.css"/>
    <script type="text/javascript" src="/static/jquery-cookie/jquery.cookie.min.js"></script>
    <script type="text/javascript" src="/static/rateyo/jquery.rateyo.js"></script>
</head>

<body>
    {% csrf_token %}
    {% include "includes/header.html" %}
    <section>
        
        <div>
            <form>
            {#{% csrf_token %}#}
            </form>
        </div>
        <div id="search_content">
            <form id="form_data">
                <input id="pk" type="hidden" value="{{ pk }}" />
                <input id="name" type="hidden" value="{{ name }}" />
            </form>
            <table>
                <thead>
                    <tr>
                        <th colspan="1">Nombre: {{ name }}</th>
                        <th colspan="3">
                            <label>Oficiales:</label>
                            <input id="oficial" name="oficial" form="form_data" type="checkbox" {% if oficial %} checked{% endif %} />
                            <label>Ordenar por:</label>
                            <select id="order" name="order" form="form_data">
                                {% for rtypeorder in TYPESORDER %}
                                    <option value="{{ rtypeorder.type }}" {% ifequal typeq rtypeorder.type %}selected{% endifequal %}>{{ rtypeorder.text }}</option>
                                {% endfor%}
                            </select>
                        </th>
                    </tr>
                    {% if results %}
                    <tr>
                        <th>Instrumentos de evaluación: </th>
                        <th></th>
                        <th></th>
                        <th>Oficial</th>
                        <th>Valoración</th>
                    </tr>
                    {% endif %}
                </thead>
                <tbody>
                    <!--
                    <tr>
                        <td>Resultado 1</td>
                        <td><button>Editar</button></td>
                        <td><button>Eliminar</button></td>
                    </tr>
                    -->
                    {% for result in results %}
                    <tr>
                        <td>{{ result.titulo }}</td>
                        <td><button onclick="window.location.href=&quot;{{ result.url_search }}?id={{result.pk}}&amp;type={{ typeq }}&amp;name={{ result.name|urlencode }}&quot;;">Consultar</button></td>
                        <td><button>Descargar</button></td>
                        <td><input type="checkbox" onclick="return false;" {% if result.oficial %} checked{% endif %} /></td>
                        <td>
                            <div id="resultrating{{result.pk}}" class=".rating"></div>
                            <script type="text/javascript">
                            $('#resultrating{{result.pk}}').rateYo({
                                rating : {% firstof result.valoracion '0' %},
                                // readOnly: true,
                            });
                            </script>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
    </section>
    <script type="text/javascript">
        $(document).ready(function(event) {
            $('#oficial').click(function(event) {
                event.preventDefault();
                var isoficial = $('#oficial').is(':checked').toString();
                var order = $('#order').val();
                window.location.href = 
                    "./mostrar?oficial=" + isoficial + 
                    "&order=" + order +
                    "&id=" + "{{idx|urlencode}}" +
                    "&type=" + "{{type_search|urlencode}}";
            });
        });
    </script>
    {% include "includes/footer.html" %}
</body>

</html>
